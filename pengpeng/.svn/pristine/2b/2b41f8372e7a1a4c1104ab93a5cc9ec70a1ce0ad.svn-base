STK.register("kit.extra.language",function(a){window.$LANG||(window.$LANG={});return function(b){var c=[].splice.call(arguments,1,arguments.length),d=[b,$LANG].concat(c),e=a.core.util.language.apply(this,d);return e}});
STK.register("kit.dom.parseDOM",function(a){return function(a){for(var b in a)a[b]&&a[b].length==1&&(a[b]=a[b][0]);return a}});
STK.register("kit.extra.reuse",function(a){return function(b,c){var d,e,f;d=a.parseParam({},c);f=[];var g=function(){var a=b();f.push({store:a,used:!0});return a},h=function(b){a.foreach(f,function(a,c){if(b===a.store){a.used=!0;return!1}})},i=function(b){a.foreach(f,function(a,c){if(b===a.store){a.used=!1;return!1}})},j=function(){for(var a=0,b=f.length;a<b;a+=1)if(f[a].used===!1){f[a].used=!0;return f[a].store}return g()};e={};e.setUsed=h;e.setUnused=i;e.getOne=j;e.getLength=function(){return f.length};return e}});
STK.register("ui.mod.layer",function(a){var b=function(a){var b={};if(a.style.display=="none"){a.style.visibility="hidden";a.style.display="";b.w=a.offsetWidth;b.h=a.offsetHeight;a.style.display="none";a.style.visibility="visible"}else{b.w=a.offsetWidth;b.h=a.offsetHeight}return b},c=function(c,d){d=d||"topleft";var e=null;if(c.style.display=="none"){c.style.visibility="hidden";c.style.display="";e=a.core.dom.position(c);c.style.display="none";c.style.visibility="visible"}else e=a.core.dom.position(c);if(d!=="topleft"){var f=b(c);if(d==="topright")e.l=e.l+f.w;else if(d==="bottomleft")e.t=e.t+f.h;else if(d==="bottomright"){e.l=e.l+f.w;e.t=e.t+f.h}}return e};return function(d){var e=a.core.dom.builder(d),f=e.list.outer[0],g=e.list.inner[0],h=a.core.dom.uniqueID(f),i={},j=a.core.evt.custEvent.define(i,"show");a.core.evt.custEvent.define(j,"hide");var k=null;i.show=function(){f.style.display="";a.core.evt.custEvent.fire(j,"show");return i};i.hide=function(){f.style.display="none";a.custEvent.fire(j,"hide");return i};i.getPosition=function(a){return c(f,a)};i.getSize=function(a){if(a||!k)k=b.apply(i,[f]);return k};i.html=function(a){a!==undefined&&(g.innerHTML=a);return g.innerHTML};i.text=function(b){b!==undefined&&(g.innerHTML=a.core.str.encodeHTML(b));return a.core.str.decodeHTML(g.innerHTML)};i.appendChild=function(a){g.appendChild(a);return i};i.getUniqueID=function(){return h};i.getOuter=function(){return f};i.getInner=function(){return g};i.getParentNode=function(){return f.parentNode};i.getDomList=function(){return e.list};i.getDomListByKey=function(a){return e.list[a]};i.getDom=function(a,b){return e.list[a]?e.list[a][b||0]:!1};i.getCascadeDom=function(b,c){return e.list[b]?a.core.dom.cascadeNode(e.list[b][c||0]):!1};return i}});
STK.register("ui.mod.dialog",function(a){return function(b,c){if(!b)throw"ui.mod.dialog need template as first parameter";var d,e,f,g,h,i,j,k,l,m,n,o;l=!0;var p=function(){l!==!1&&e.hide()},q=function(){d=a.parseParam({t:null,l:null,width:null,height:null},c);e=a.ui.mod.layer(b,d);g=e.getOuter();h=e.getDom("title");k=e.getDom("title_content");i=e.getDom("inner");j=e.getDom("close");a.addEvent(j,"click",function(b){a.preventDefault(b);n();return!1});a.custEvent.add(e,"show",function(){a.hotKey.add(document.documentElement,["esc"],p,{type:"keyup",disableInInput:!0})});a.custEvent.add(e,"hide",function(){a.hotKey.remove(document.documentElement,["esc"],p,{type:"keyup"});l=!0})};q();o=a.objSup(e,["show","hide"]);n=function(b){if(typeof m=="function"&&!b&&m()===!1)return!1;o.hide();a.contains(document.body,e.getOuter())&&document.body.removeChild(e.getOuter());return f};f=e;f.show=function(){a.contains(document.body,e.getOuter())||document.body.appendChild(e.getOuter());o.show();return f};f.hide=n;f.setPosition=function(a){g.style.top=a.t+"px";g.style.left=a.l+"px";return f};f.setMiddle=function(){var b=a.core.util.winSize(),c=e.getSize(!0),d=a.core.util.scrollPos().top+(b.height-c.h)/2;g.style.top=(d>0?d:0)+"px";g.style.left=(b.width-c.w)/2+"px";return f};f.setTitle=function(a){k.innerHTML=a;return f};f.setContent=function(a){typeof a=="string"?i.innerHTML=a:i.appendChild(a);return f};f.clearContent=function(){while(i.children.length)a.removeNode(i.children[0]);return f};f.setAlign=function(){};f.setBeforeHideFn=function(a){m=a};f.clearBeforeHideFn=function(){m=null};f.unsupportEsc=function(){l=!1};f.supportEsc=function(){l=!0};return f}});
STK.register("kit.dom.fix",function(a){function f(c,e,f){if(!!d(c)){var g="fixed",h,i,j,k,l=c.offsetWidth,m=c.offsetHeight,n=a.core.util.winSize(),o=0,p=0,q=a.core.dom.cssText(c.style.cssText);if(!b){g="absolute";var r=a.core.util.scrollPos();o=h=r.top;p=i=r.left;switch(e){case"lt":h+=f[1];i+=f[0];break;case"lb":h+=n.height-m-f[1];i+=f[0];break;case"rt":h+=f[1];i+=n.width-l-f[0];break;case"rb":h+=n.height-m-f[1];i+=n.width-l-f[0];break;case"c":default:h+=(n.height-m)/2+f[1];i+=(n.width-l)/2+f[0]}j=k=""}else{h=k=f[1];i=j=f[0];switch(e){case"lt":k=j="";break;case"lb":h=j="";break;case"rt":i=k="";break;case"rb":h=i="";break;case"c":default:h=(n.height-m)/2+f[1];i=(n.width-l)/2+f[0];k=j=""}}if(e=="c"){h<o&&(h=o);i<p&&(i=p)}q.push("position",g).push("top",h+"px").push("left",i+"px").push("right",j+"px").push("bottom",k+"px");c.style.cssText=q.getCss()}}function e(b){b=a.core.arr.isArray(b)?b:[0,0];for(var c=0;c<2;c++)typeof b[c]!="number"&&(b[c]=0);return b}function d(b){return a.core.dom.getStyle(b,"display")!="none"}var b=!(a.core.util.browser.IE6||document.compatMode!=="CSS1Compat"&&STK.IE),c=/^(c)|(lt)|(lb)|(rt)|(rb)$/;return function(d,g,h){var i,j,k=!0,l;if(a.core.dom.isNode(d)&&c.test(g)){var m={getNode:function(){return d},isFixed:function(){return k},setFixed:function(a){(k=!!a)&&f(d,i,j);return this},setAlign:function(a,b){if(c.test(a)){i=a;j=e(b);k&&f(d,i,j)}return this},destroy:function(){b||b&&a.core.evt.removeEvent(window,"scroll",n);a.core.evt.removeEvent(window,"resize",n);a.core.evt.custEvent.undefine(l)}};l=a.core.evt.custEvent.define(m,"beforeFix");m.setAlign(g,h);function n(c){c=c||window.event;a.core.evt.custEvent.fire(l,"beforeFix",c.type);k&&(!b||i=="c")&&f(d,i,j)}b||a.core.evt.addEvent(window,"scroll",n);a.core.evt.addEvent(window,"resize",n);return m}}});
STK.register("ui.mask",function(a){function k(b){var c;(c=b.getAttribute(f))||b.setAttribute(f,c=a.getUniqueKey());return">"+b.tagName.toLowerCase()+"["+f+'="'+c+'"]'}function j(){b=a.C("div");var c='<div node-type="outer">';a.core.util.browser.IE6&&(c+='<div style="position:absolute;width:100%;height:100%;"></div>');c+="</div>";b=a.builder(c).list.outer[0];document.body.appendChild(b);e=!0;d=a.kit.dom.fix(b,"lt");var f=function(){var c=a.core.util.winSize();b.style.cssText=a.core.dom.cssText(b.style.cssText).push("width",c.width+"px").push("height",c.height+"px").getCss()};i.add(d,"beforeFix",f);f()}var b,c=[],d,e=!1,f="STK-Mask-Key",g=a.core.dom.setStyle,h=a.core.dom.getStyle,i=a.core.evt.custEvent,l={getNode:function(){return b},show:function(c,f){if(e){c=a.core.obj.parseParam({opacity:.3,background:"#000000"},c);b.style.background=c.background;g(b,"opacity",c.opacity);b.style.display="";d.setAlign("lt");f&&f()}else{j();l.show(c,f)}return l},hide:function(){b.style.display="none";c=[];return l},showUnderNode:function(d,e){a.isNode(d)&&l.show(e,function(){g(b,"zIndex",h(d,"zIndex"));var e=k(d),f=a.core.arr.indexOf(c,e);f!=-1&&c.splice(f,1);c.push(e);a.core.dom.insertElement(d,b,"beforebegin")});return l},back:function(){if(c.length<1)return l;var d,e;c.pop();if(c.length<1)l.hide();else if((e=c[c.length-1])&&(d=a.sizzle(e,document.body)[0])){g(b,"zIndex",h(d,"zIndex"));a.core.dom.insertElement(d,b,"beforebegin")}else l.back();return l},destroy:function(){i.remove(d);b.style.display="none"}};return l});
STK.register("kit.dom.drag",function(a){return function(b,c){var d,e,f,g,h,i,j,k,l=function(){m();n()},m=function(){d=a.parseParam({moveDom:b,perchStyle:"border:solid #999999 2px;",dragtype:"perch",actObj:{},pagePadding:5},c);f=d.moveDom;e={};g={};h=a.drag(b,{actObj:d.actObj});if(d.dragtype==="perch"){i=a.C("div");j=!1;k=!1;f=i}b.style.cursor="move"},n=function(){a.custEvent.add(d.actObj,"dragStart",o);a.custEvent.add(d.actObj,"dragEnd",p);a.custEvent.add(d.actObj,"draging",q)},o=function(c,e){document.body.style.cursor="move";var f=a.core.util.pageSize().page;g=a.core.dom.position(d.moveDom);g.pageX=e.pageX;g.pageY=e.pageY;g.height=d.moveDom.offsetHeight;g.width=d.moveDom.offsetWidth;g.pageHeight=f.height;g.pageWidth=f.width;if(d.dragtype==="perch"){var h=[];h.push(d.perchStyle);h.push("position:absolute");h.push("z-index:"+(d.moveDom.style.zIndex+10));h.push("width:"+d.moveDom.offsetWidth+"px");h.push("height:"+d.moveDom.offsetHeight+"px");h.push("left:"+g.l+"px");h.push("top:"+g.t+"px");i.style.cssText=h.join(";");k=!0;setTimeout(function(){if(k){document.body.appendChild(i);j=!0}},100)}b.setCapture!==undefined&&b.setCapture()},p=function(a,c){document.body.style.cursor="auto";b.setCapture!==undefined&&b.releaseCapture();if(d.dragtype==="perch"){k=!1;d.moveDom.style.top=i.style.top;d.moveDom.style.left=i.style.left;if(j){document.body.removeChild(i);j=!1}}},q=function(a,b){var c=g.t+(b.pageY-g.pageY),e=g.l+(b.pageX-g.pageX),h=c+g.height,i=e+g.width,j=g.pageHeight-d.pagePadding,k=g.pageWidth-d.pagePadding;if(h<j&&c>0)f.style.top=c+"px";else{var l;h>=j&&(l=j-g.height);if(c<0||l<0)l=0;f.style.top=l+"px"}if(i<k&&e>0)f.style.left=e+"px";else{e<0&&(f.style.left="0px");i>=k&&(f.style.left=k-g.width+"px")}};l();e.destroy=function(){document.body.style.cursor="auto";typeof f.setCapture=="function"&&f.releaseCapture();if(d.dragtype==="perch"){k=!1;if(j){document.body.removeChild(i);j=!1}}a.custEvent.remove(d.actObj,"dragStart",o);a.custEvent.remove(d.actObj,"dragEnd",p);a.custEvent.remove(d.actObj,"draging",q);h.destroy&&h.destroy();d=null;f=null;g=null;h=null;i=null;j=null;k=null};e.getActObj=function(){return d.actObj};return e}});
STK.register("ui.dialog",function(a){var b='<div class="W_layer" node-type="outer" style="display:none;position:absolute;z-index:10001"><div class="bg"><table border="0" cellspacing="0" cellpadding="0"><tr><td><div class="content" node-type="layoutContent"><div class="title" node-type="title"><span node-type="title_content"></span></div><a href="javascript:void(0);" class="W_close" title="#L{关闭}" node-type="close"></a><div node-type="inner"></div></div></td></tr></table></div></div>',c=a.kit.extra.language,d=null,e,f=function(){var b=a.ui.mod.dialog(c(e.template));a.custEvent.add(b,"show",function(){a.ui.mask.showUnderNode(b.getOuter())});a.custEvent.add(b,"hide",function(){a.ui.mask.back();b.setMiddle()});a.kit.dom.drag(b.getDom("title"),{actObj:b,moveDom:b.getOuter()});b.destroy=function(){g(b);try{b.hide(!0)}catch(a){}};return b},g=function(a){a.setTitle("").clearContent();d.setUnused(a)};return function(c){e=a.parseParam({template:b,isHold:!1},c);var h=e.isHold;e=a.core.obj.cut(e,["isHold"]);d||(d=a.kit.extra.reuse(f));var i=d.getOne();h||a.custEvent.add(i,"hide",function(){a.custEvent.remove(i,"hide",arguments.callee);g(i)});return i}});
STK.register("ui.alert",function(a){var b='<div node-type="outer" class="layer_point"><dl class="point clearfix"><dt><span class="" node-type="icon"></span></dt><dd node-type="inner"><p class="S_txt1" node-type="textLarge"></p><p class="S_txt2" node-type="textSmall"></p></dd></dl><div class="btn"><a href="javascript:void(0)" class="W_btn_d" node-type="OK"></a></div></div>',c={success:"icon_succM",error:"icon_errorM",warn:"icon_warnM","delete":"icon_delM",question:"icon_questionM"},d=a.kit.extra.language,e=null,f=function(a,b){a.getDom("icon").className=b.icon;a.getDom("textLarge").innerHTML=b.textLarge;a.getDom("textSmall").innerHTML=b.textSmall;a.getDom("OK").innerHTML="<span>"+b.OKText+"</span>"};return function(g,h){var i,j,k,l,m;i=a.parseParam({title:d("#L{提示}"),icon:"warn",textLarge:g,textSmall:"",OK:a.funcEmpty,OKText:d("#L{确定}"),timeout:0},h);i.icon=c[i.icon];j={};e||(e=a.kit.extra.reuse(function(){var c=a.ui.mod.layer(d(b));return c}));k=e.getOne();l=a.ui.dialog();l.setContent(k.getOuter());l.setTitle(i.title);f(k,i);var n=function(b){a.preventDefault(b);l.hide()};a.addEvent(k.getDom("OK"),"click",n);a.custEvent.add(l,"hide",function(){a.custEvent.remove(l,"hide",arguments.callee);a.removeEvent(k.getDom("OK"),"click",n);e.setUnused(k);clearTimeout(m);i.OK()});i.timeout&&(m=setTimeout(l.hide,i.timeout));l.show().setMiddle();k.getDom("OK").focus();j.alt=k;j.dia=l;return j}});
STK.register("ui.confirm",function(a){var b='<div node-type="outer" class="layer_point"><dl class="point clearfix"><dt><span class="" node-type="icon"></span></dt><dd node-type="inner"><p class="S_txt1" node-type="textLarge"></p><p class="S_txt2" node-type="textComplex"></p><p class="S_txt2" node-type="textSmall"></p></dd></dl><div class="btn"><a href="javascript:void(0)" class="W_btn_d" node-type="OK"></a><a href="javascript:void(0)" class="W_btn_b" node-type="cancel"></a></div></div>',c={success:"icon_succM",error:"icon_errorM",warn:"icon_warnM","delete":"icon_delM",question:"icon_questionM"},d=a.kit.extra.language,e=null;return function(f,g){var h,i,j,k,l,m;h=a.parseParam({title:d("#L{提示}"),icon:"question",textLarge:f,textComplex:"",textSmall:"",OK:a.funcEmpty,OKText:d("#L{确定}"),cancel:a.funcEmpty,cancelText:d("#L{取消}"),hideCallback:a.funcEmpty},g);h.icon=c[h.icon];i={};e||(e=a.kit.extra.reuse(function(){var c=a.ui.mod.layer(b);return c}));j=e.getOne();k=a.ui.dialog();k.setContent(j.getOuter());j.getDom("icon").className=h.icon;j.getDom("textLarge").innerHTML=h.textLarge;j.getDom("textComplex").innerHTML=h.textComplex;j.getDom("textSmall").innerHTML=h.textSmall;j.getDom("OK").innerHTML="<span>"+h.OKText+"</span>";j.getDom("cancel").innerHTML="<span>"+h.cancelText+"</span>";k.setTitle(h.title);var n=function(){l=!0;m=a.htmlToJson(j.getDom("textComplex"));k.hide()};a.addEvent(j.getDom("OK"),"click",n);a.addEvent(j.getDom("cancel"),"click",k.hide);a.custEvent.add(k,"hide",function(){a.custEvent.remove(k,"hide",arguments.callee);a.removeEvent(j.getDom("OK"),"click",n);a.removeEvent(j.getDom("cancel"),"click",k.hide);e.setUnused(j);l?h.OK(m):h.cancel(m);g.hideCallback()});k.show().setMiddle();j.getDom("OK").focus();i.cfm=j;i.dia=k;return i}});
STK.register("ui.litePrompt",function(a){var b=a.kit.extra.language,c=a.core.util.easyTemplate;return function(b,d){var e,f,g,h,i,d=a.parseParam({hideCallback:a.core.func.empty,type:"succM",msg:"",timeout:""},d),j=d.template||'<#et temp data><div class="W_layer" node-type="outer"><div class="bg"><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td><div class="content layer_mini_info_big" node-type="inner"><p class="clearfix"><span class="icon_${data.type}"></span>${data.msg}&nbsp; &nbsp; &nbsp;</p></div></td></tr></tbody></table></div></div></#et>',k=c(j,{type:d.type,msg:b}).toString();f={};g=a.ui.mod.layer(k);i=g.getOuter();a.custEvent.add(g,"hide",function(){a.ui.mask.back();d.hideCallback&&d.hideCallback();a.custEvent.remove(g,"hide",arguments.callee);clearTimeout(h)});a.custEvent.add(g,"show",function(){document.body.appendChild(i);a.ui.mask.showUnderNode(i);a.ui.mask.getNode().style.zIndex=10002});g.show();d.timeout&&(h=setTimeout(g.hide,d.timeout));var l=a.core.util.winSize(),m=g.getSize(!0);i.style.top=a.core.util.scrollPos().top+(l.height-m.h)/2+"px";i.style.left=(l.width-m.w)/2+"px";i.style.zIndex=10002;f.layer=g;return f}});
STK.register("common.group.addGroupPanel",function(a){var b='<#et addGroup data><div node-type="addGroupPanel" class="form_table lsfl_edit_list"><dl class="clearfix"><dt><span class="must CH S_spetxt" style="color: #f00;">*</span>#L{分组名：}</dt><dd class="conbox"><input watermark="#L{请输入分组名称，最多8个字}" value="#L{请输入分组名称，最多8个字}" node-type="name" name="name" type="text" class="W_inputStp"><div style="display:none;" node-type="err_name" class="M_notice_del clearfix"></div></dd></dl><dl class="clearfix"><dt>#L{分组描述：}</dt><dd class="conbox"><textarea watermark="#L{请输入分组描述，最多70个字}"" node-type="desc" name="desc" class="W_inputStp list_desc" rows="" cols="">#L{请输入分组描述，最多70个字}</textarea><div style="display:none;" node-type="err_desc" class="M_notice_del clearfix"></div></dd></dl></div></#et>',c='<span class="icon_del"></span><span class="txt">{errMsg}</span>',d=a.kit.extra.language;return function(e){e=e||{};var f={},g=a.getUniqueKey(),h=e.data||{},i=e.mode||"private",j=e.template||b,k=a.core.util.easyTemplate(d(j)),l=a.core.dom.builder(k({ukey:g,mode:i}).toString()),m=a.kit.dom.parseDOM(l.list),n=e.checkList||{name:function(b){var c=a.trim(b),e=a.bLength(c);if(!e)return d("#L{请输入分组名称}");if(e>16)return d("#L{请输入1～16个字符}")}},o={show:function(a,b){var d=m["err_"+b];if(!!d){d.innerHTML=c.replace(/\{errMsg\}/i,a);d.style.display=""}},hide:function(a){var b=m["err_"+a];!b||(b.style.display="none")}},p={blur:function(b){var c=a.fixEvent(b).target,d=c.getAttribute("node-type"),e=c.value,f=n[d],g=c.getAttribute("watermark"),h=typeof f=="function"?f(e):"";a.trim(e)||(c.value=g);h&&o.show(h,d)},focus:function(b){var c=a.fixEvent(b).target,d=c.getAttribute("node-type"),e=c.getAttribute("watermark");a.trim(c.value)===e&&(c.value="");o.hide(d)},descKeyup:function(b){a.bLength(m.desc.value)>140&&(m.desc.value=a.leftB(m.desc.value,140))},nameKeyup:function(b){a.bLength(m.name.value)>16&&(m.name.value=a.leftB(m.name.value,16))}};a.addEvent(m.name,"blur",p.blur);a.addEvent(m.desc,"blur",p.blur);a.addEvent(m.name,"focus",p.focus);a.addEvent(m.desc,"focus",p.focus);a.addEvent(m.desc,"keyup",p.descKeyup);a.addEvent(m.name,"keyup",p.nameKeyup);var q=function(){return m.addGroupPanel},r=function(b){var c,d;for(var e in b){c=m[e];if(!a.isArray(c)){d=c.getAttribute("watermark");a.trim(b[e])===d&&(b[e]="");e==="tags"&&(b[e]=b[e].replace(/[、|\s|，|,|;|；]+/ig,","))}}return b},s=function(b){var c=a.trim(b.value),d=b.getAttribute("watermark");c===d&&(c="");return c},t=function(){var b=!0;for(var c in n){var d=n[c](s(m[c]));if(d){b=!1;o.show(d,c);break}}return b?r(a.htmlToJson(m.addGroupPanel)):!1},u=function(b){for(var c in b){var d=m[c];if(a.isArray(m[c]))for(var e=d.length;e--;)d[e].value===b[c]&&(d[e].checked=!0);else{var f=a.isArray(b[c])?b[c].join(" "):b[c];f=a.decodeHTML(f);f&&m[c]&&(m[c].value=f)}}h=b},v=function(){u(h)},w=function(){a.removeEvent(m.name,"blur",p.blur);a.removeEvent(m.desc,"blur",p.blur);a.removeEvent(m.tags,"blur",p.blur);a.removeEvent(m.name,"focus",p.focus);a.removeEvent(m.desc,"focus",p.focus);a.removeEvent(m.tags,"focus",p.focus);a.removeEvent(m.desc,"keyup",p.descKeyup);a.removeEvent(m.name,"keyup",p.nameKeyup);p=null;m=null};u(h);f.reset=v;f.getOuter=q;f.setData=u;f.destroy=w;f.getData=t;return f}});
STK.register("kit.io.ajax",function(a){var b=function(b,c,d){c=c|0||1;d=d||"fail";var e=b.args;e.__rnd&&delete e.__rnd;(new Image).src="http://weibolog.sinaapp.com/?t="+c+"&u="+encodeURIComponent(b.url)+"&p="+encodeURIComponent(a.core.json.jsonToQuery(e))+"&m="+d};return function(c){var d={},e=[],f=null,g=!1,h=a.parseParam({url:"",method:"get",responseType:"json",timeout:3e4,onTraning:a.funcEmpty,isEncode:!0},c);h.onComplete=function(a){g=!1;c.onComplete(a,h.args);setTimeout(i,0)};h.onFail=function(a){g=!1;if(typeof c.onFail=="function")try{c.onFail(a,h.args)}catch(d){}setTimeout(i,0);try{b(h)}catch(d){}};h.onTimeout=function(a){try{b(h);c.onTimeout(a)}catch(d){}};var i=function(){if(!!e.length){if(g===!0)return;g=!0;h.args=e.shift();if(h.method.toLowerCase()=="post"){var b=a.core.util.URL(h.url);b.setParam("__rnd",+(new Date));h.url=b.toString()}f=a.ajax(h)}},j=function(a){while(e.length)e.shift();g=!1;if(f)try{f.abort()}catch(b){}f=null};d.request=function(a){a||(a={});c.noQueue&&j();if(!c.uniqueRequest||!f){e.push(a);a._t=0;i()}};d.abort=j;return d}});
STK.register("kit.io.jsonp",function(a){return function(b){var c=a.parseParam({url:"",method:"get",responseType:"json",varkey:"_v",timeout:3e4,onComplete:a.funcEmpty,onTraning:a.funcEmpty,onFail:a.funcEmpty,isEncode:!0},b),d=[],e={},f=!1,g=function(){if(!!d.length){if(f===!0)return;f=!0;e.args=d.shift();e.onComplete=function(a){f=!1;c.onComplete(a,e.args);setTimeout(g,0)};e.onFail=function(a){f=!1;c.onFail(a);setTimeout(g,0)};a.jsonp(a.core.json.merge(c,{args:e.args,onComplete:function(a){e.onComplete(a)},onFail:function(a){try{e.onFail(a)}catch(b){}}}))}},h={};h.request=function(a){a||(a={});d.push(a);a._t=1;g()};h.abort=function(a){while(d.length)d.shift();f=!1;e=null};return h}});
STK.register("kit.io.ijax",function(a){return function(b){var c=a.parseParam({url:"",timeout:3e4,isEncode:!0,abaurl:null,responseName:null,varkey:"callback",abakey:"callback"},b),d=[],e=null,f=!1;c.onComplete=function(a,d){f=!1;b.onComplete(a,c.form,d);c.form=null;c.args=null;setTimeout(g,0)};c.onFail=function(a,d){f=!1;b.onFail(a,c.form,d);c.form=null;c.args=null;setTimeout(g,0)};var g=function(){var b;if(!!d.length){if(f===!0)return;f=!0;b=d.shift();c.args=b.args;c.form=b.form;e=a.ijax(c)}},h=function(a){while(d.length)d.shift();f=!1;if(e)try{e.abort()}catch(b){}e=null},i={};i.request=function(c,e){if(!a.isNode(c))throw"[kit.io.ijax.request] need a form as first parameter";e||(e={});b.noQueue&&h();d.push({form:c,args:e});g()};i.abort=h;return i}});
STK.register("kit.io.inter",function(a){var b=a.core.json.merge;return function(){var c={},d={},e={},f=function(a,b){return function(c,d){try{b.onComplete(c,d)}catch(f){}try{if(c.code==="100000")b.onSuccess(c,d);else{if(c.code==="100002"){location.href=c.data;return}b.onError(c,d)}}catch(f){}for(var g in e[a])try{e[a][g](c,d)}catch(f){}}};c.register=function(a,b){if(typeof d[a]!="undefined")throw a+" registered";d[a]=b;e[a]={}};c.addHook=function(b,c){var d=a.core.util.getUniqueKey();e[b][d]=c;return d};c.rmHook=function(a,b){e[a]&&e[a][b]&&delete e[a][b]};c.getTrans=function(c,e){var g=b(d[c],e);g.onComplete=f(c,e);var h=d[c].requestMode,i="ajax";if(h==="jsonp"||h==="ijax")i=h;return a.kit.io[i](g)};c.request=function(c,e,g){var h=b(d[c],e);h.onComplete=f(c,e);h=a.core.obj.cut(h,["noqueue"]);h.args=g;var i=d[c].requestMode;return i==="jsonp"?a.jsonp(h):i==="ijax"?a.ijax(h):a.ajax(h)};return c}});
STK.register("common.trans.group",function(a){var b=a.kit.io.inter(),c=b.register;c("add",{url:"/aj/f/group/add?_wv=5",method:"post"});c("modify",{url:"/aj/relation/rename?_wv=5",method:"post"});c("del",{url:"/aj/relation/delete?_wv=5",method:"post"});c("info",{url:"/aj/f/group/getgroupinfo?_wv=5",method:"get"});c("set",{url:"/aj3/attention/aj_group_update_v4.php",method:"post"});c("batchSet",{url:"/aj3/attention/aj_group_batchupdate_v4.php",method:"post"});c("list",{url:"/aj/f/group/list?_wv=5",method:"get"});c("order",{url:"/aj/f/group/order?_wv=5",method:"post"});c("listbygroup",{url:"/aj/f/attchoose?_wv=5",method:"post"});c("infolist",{url:"/aj/f/attfilterlist?_wv=5",method:"get"});c("orientGroup",{url:"/aj/f/group/groupmembers?_wv=5",method:"get"});c("recommendfollow",{url:"/aj3/recommend/aj_addrecommend.php",method:"post"});c("groupupdate",{url:"/aj/relation/groupupdate?_wv=5",method:"post"});c("unInterest",{url:"/aj/f/group/notinterest?_wv=5",method:"post"});c("editdesc",{url:"/aj/f/group/editdesc?_wv=5",method:"post"});c("update",{url:"/aj/f/group/update?_wv=5",method:"post"});c("followgroup",{url:"/aj/f/group/followgroup?_wv=5",method:"post"});c("getGroupDesc",{url:"/aj/f/group/getdesc?_wv=5",method:"get"});c("closebubble",{url:"/aj/bubble/closebubble?_wv=5",method:"get"});return b});
STK.register("common.trans.relation",function(a){var b=a.kit.io.inter(),c=b.register;c("recommendfollow",{url:"/aj/f/recomafterfollow?_wv=5",method:"get"});c("closerecommend",{url:"/aj/f/closerecommend?_wv=5",method:"get"});c("newuserguide",{url:"/aj/user/interest/newuserguide?_wv=5",method:"get"});c("mayinterested",{url:"/aj/user/interest/list?_wv=5",method:"get"});c("uninterested",{url:"/aj/user/interest/uninterested?_wv=5",method:"post"});c("userCard",{url:"/aj/user/cardv5?_wv=5",method:"get"});c("follow",{url:"/aj/f/followed?_wv=5",method:"post"});c("unFollow",{url:"/aj/f/unfollow?_wv=5",method:"post"});c("follow_register",{url:"/nguide/aj/relation/followed?_wv=5",method:"post"});c("unfollow_register",{url:"/nguide/aj/relation/unfollow?_wv=5",method:"post"});c("block",{url:"/aj/f/addblack?_wv=5",method:"post"});c("unBlock",{url:"/aj/f/delblack?_wv=5",method:"post"});c("removeFans",{url:"/aj/f/remove?_wv=5",method:"post"});c("requestFollow",{url:"/ajax/relation/requestfollow?_wv=5",method:"post"});c("questions",{url:"/aj/invite/attlimit?_wv=5",method:"get"});c("answer",{url:"/aj/invite/att?_wv=5",method:"post"});c("setRemark",{url:"/aj/f/remarkname?_wv=5",method:"post"});c("recommendusers",{url:"/aj/f/recommendusers?_wv=5",method:"get"});c("recommendAttUsers",{url:"/aj/f/worthfollowusers?_wv=5",method:"get"});c("recommendPopularUsers",{url:"/aj/user/interest/recommendpopularusers?_wv=5",method:"get"});c("mayinterestedweiqun",{url:"/aj/weiqun/getinterestedlist?_wv=5",method:"get"});c("moreData",{url:"/aj/f/listuserdetail?_wv=5",method:"get"});c("getInvite",{url:"/aj/invite/unread?_wv=5",method:"get"});c("quiet_addUser",{url:"/aj/f/addwhisper?_wv=5",method:"post"});c("quiet_removeUser",{url:"/aj/f/delwhisper?_wv=5",method:"post"});c("quiet_know",{url:"/aj/tipsbar/closetipsbar?_wv=5",method:"post"});c("groupUserList",{url:"/aj/f/group/getgroupmembers?_wv=5",method:"get"});c("smart_sort",{url:"/aj/mblog/mblogcard?_wv=5",method:"post"});c("groupSubmit",{url:"/aj/f/group/list?_wv=5",method:"get"});c("wqList",{url:"/aj/proxy?api=http://recom.i.t.sina.com.cn/1/weiqun/weiqun_may_interest.php",method:"get"});c("uninterestedWq",{url:"/aj/proxy?api=http://recom.i.t.sina.com.cn/1/weiqun/weiqun_uninterest.php",method:"get"});c("inviteNeglect",{url:"/aj/invite/handleinvite?_wv=5",method:"post"});c("checkNeglect",{url:"/aj/invite/shieldedlist?_wv=5",method:"post"});c("inviteLift",{url:"/aj/invite/lift?_wv=5",method:"post"});c("inviteAccept",{url:"/aj/invite/handleinvite?_wv=5",method:"post"});c("searchByTel",{url:"/aj/relation/getuserbymobile?_wv=5",method:"post"});c("inviteCloseTips",{url:"/aj/invite/closetips?_wv=5",method:"post"});c("checkrelation",{url:"/aj/f/checkrelation?_wv=5",method:"post"});c("addCloseFriend",{url:"/aj/f/createclosefriend?_wv=5",method:"post"});c("removeClsFrd",{url:"/aj/f/removeclosefriend?_wv=5",method:"post"});c("cfInviteUnread",{url:"/aj/invite/unread?_wv=5",method:"get"});c("recommendCf",{url:"/aj/user/closefriend/recommend?_wv=5",method:"get"});c("clearInvalidUsers",{url:"/aj/f/clearinvalidfriends?_wv=5",method:"post"});c("unIstCf",{url:"/aj/user/closefriend/deny?_wv=5",method:"post"});c("checkcloserelation",{url:"/aj/f/checkcloserelation?_wv=5",method:"post"});c("closeunfollow",{url:"/aj/profile/closeunfollow?_wv=5",method:"post"});c("fanslikemore",{url:"/aj/relation/fanslikemore?_wv=5",method:"get"});c("getProfileInfo",{url:"/aj/relation/getprofileinfo?_wv=5",method:"get"});c("interestlist",{url:"/aj/user/interest/profileinfo?_wv=5",method:"get"});c("recommendGroupMember",{url:"/aj/user/group/recommend?_wv=5",method:"get"});return b});
STK.register("common.dialog.addGroup",function(a){return function(b){var c=a.kit.extra.language,d='<div node-type="outer" class="layer_setup_followlists edit_list"><div node-type="dialog_group_list" class="form_table lsfl_edit_list"></div><div node-type="btnBox" class="btn"><a node-type="submit" href="javascript:;" class="W_btn_d"><span>#L{保存}</span></a><a node-type="cancel" href="javascript:;" class="W_btn_b"><span>#L{取消}</span></a></div></div>',e={},f=a.ui.dialog({isHold:!0}),g=a.core.dom.builder(c(d)),h=a.kit.dom.parseDOM(g.list),i,j,k,l,m=a.common.group.addGroupPanel(),n;h.dialog_group_list.innerHTML="";a.core.dom.insertElement(h.dialog_group_list,m.getOuter(),"afterbegin");f.appendChild(h.outer);var o={onSuccess:function(b,d){r();var e=a.ui.litePrompt(c("#L{设置成功}"),{type:"succM",timeout:1e3,hideCallback:function(){if(!d.gid){var a=b.data;for(var c in a)if(a[c].belong===1){d.gid=a[c].gid;break}}typeof k=="function"&&k(d||{},b.data)}})},onError:function(b,d){b&&b.code==="100060"?b.msg&&a.ui.confirm(b.msg,{icon:"warn",OKText:c("#L{立刻绑定}"),OK:function(){window.location.href="http://account.weibo.com/settings/mobile";return a.preventDefault()}}):b.msg&&a.ui.alert(b.msg)}},p={submit:function(b){var c=m.getData();n&&(c=a.core.json.merge(n,c));if(!!c){j&&(c.gid=j);i.request(c)}},cancel:function(a){r()}};a.addEvent(h.submit,"click",p.submit);a.addEvent(h.cancel,"click",p.cancel);var q=function(b){b=b||{};j=b.gid;k=b.OK;l=b.publish;if(b.refer){n=b.refer;delete b.refer}if(j){f.setTitle(c("#L{编辑分组信息}"));i=a.common.trans.group.getTrans("modify",{onSuccess:o.onSuccess,onError:o.onError,onFail:o.onError})}else{f.setTitle(c("#L{创建分组}"));i=a.common.trans.group.getTrans("add",{onSuccess:o.onSuccess,onError:o.onError,onFail:o.onError})}f.show().setMiddle();delete b.OK;delete b.publish;m.setData(b)},r=function(){f.hide()},s=function(){a.removeEvent(h.submit,"click",p.submit);a.removeEvent(h.cancel,"click",p.cancel);m.destroy()};e.show=q;e.hide=r;e.destroy=s;return e}});
STK.register("pl.leftnav.relation.source.init",function(a){return function(b){var c={},d=a.kit.extra.language,e,f,g,h={open:d('#L{展开}<span class="W_arrow">»</span>'),close:d('#L{收起}<span class="W_arrow">«</span>')},i={open:function(a){if(!!e.moreGroup){var b=e.moreGroup.style.display!=="none";a.el.innerHTML=b?h.open:h.close;e.moreGroup.style.display=b?"none":""}},addGroup:function(b){a.common.dialog.addGroup().show({OK:function(a){window.location.href="/"+$CONFIG.uid+"/myfollow?gid="+a.gid},publish:!0})},changeClass:function(b){var c=b.el;a.foreach(g,function(d){var e=d;c!=d?a.removeClassName(e,"lev_curr"):a.addClassName(b.el,"lev_curr")});b.el.href.indexOf("myfollow")!=-1&&a.addClassName(g[0],"lev_curr")}},j=function(){k();l();m()},k=function(){if(!a.core.dom.isNode(b))throw"[STK.comp.leftnav.relation]: node is not a Element!"},l=function(){var c=a.core.dom.builder(b);e=a.kit.dom.parseDOM(c.list);g=a.sizzle('[action-type="leftnav_link"]',b)},m=function(){f=a.core.evt.delegatedEvent(b);f.add("open","click",i.open);f.add("addGroup","click",i.addGroup);f.add("leftnav_link","click",i.changeClass)},n=function(){};j();c.destroy=n;return c}});
STK.pageletM.register("pl.leftnav.relation.index",function(a){var b=a.E("pl_leftNav_relation"),c=a.pl.leftnav.relation.source.init(b);return c});
